(()=>{var e={};e.id=619,e.ids=[619],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},32081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},14551:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>d,routeModule:()=>m,tree:()=>c}),r(63395),r(35866),r(68295);var s=r(23191),i=r(88716),l=r(37922),a=r.n(l),o=r(95231),n={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>o[e]);r.d(t,n);let c=["",{children:["(protected)",{children:["chat",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,63395)),"/root/graphics-designer-website/src/app/(protected)/chat/page.js"]}]},{}]},{"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,68295)),"/root/graphics-designer-website/src/app/layout.js"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],d=["/root/graphics-designer-website/src/app/(protected)/chat/page.js"],p="/(protected)/chat/page",u={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/(protected)/chat/page",pathname:"/chat",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},48946:(e,t,r)=>{Promise.resolve().then(r.bind(r,71922))},94019:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(62881).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},71922:(e,t,r)=>{"use strict";r.d(t,{default:()=>D});var s=r(10326),i=r(65188),l=r(46226),a=r(62881);let o=(0,a.Z)("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);r(61561);let n=(0,a.Z)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var c=r(55892),d=r(17577),p=r(56348);function u({message:e,isDifferentSender:t}){return(0,s.jsxs)("div",{className:"flex-center-start gap-x-2",children:[t?s.jsx(l.default,{src:c.Z,alt:"logo",height:40,width:40}):s.jsx("div",{className:"w-10"}),(0,s.jsxs)("div",{className:"relative mt-2 max-w-max rounded-xl border bg-primary-green px-3 py-2 font-medium text-primary-white",children:[e?.imageUrl&&s.jsx(l.default,{src:(0,p.o)(e?.imageUrl),alt:e?.text,height:200,width:200,className:"h-[160px] w-auto"}),s.jsx("p",{children:e?.text})]})]})}function m({message:e}){return(0,s.jsxs)("div",{className:"mt-2 max-w-max rounded-xl bg-gray-200 px-3 py-2",children:[e?.imageUrl&&s.jsx(l.default,{src:(0,p.o)(e?.imageUrl),alt:e?.text,height:200,width:200,className:"h-[160px] w-auto"}),s.jsx("p",{className:"font-medium text-primary-black",children:e?.text})]})}var h=r(78466),x=r(77607);let{useSendMessageMutation:f,useGetMessagesQuery:g,useUploadImageMutation:b}=h.u.injectEndpoints({endpoints:e=>({sendMessage:e.mutation({query:e=>({url:"/messages/send-messages",method:"POST",body:e}),invalidatesTags:[x.U.messages]}),uploadImage:e.mutation({query:e=>({url:"/upload",method:"POST",body:e}),invalidatesTags:[x.U.messages]}),getMessages:e.query({query:e=>({url:`/messages/my-messages/${e}`,method:"GET"}),providesTags:[x.U.messages]})})});var v=r(74723),w=r(70235),j=r(23288);let y=(0,a.Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var N=r(25842),R=r(2082);class S extends d.Component{constructor(e){super(e),this.wrapperRef=void 0,this.bottomRef=void 0,this.bottomRef=d.createRef(),this.wrapperRef=d.createRef(),this.handleScroll=this.handleScroll.bind(this),this.props.debug&&console.log("Component cstr")}getSnapshotBeforeUpdate(){if(this.props.debug&&console.log("Component ",this.getSnapshotBeforeUpdate.name),this.wrapperRef.current&&this.bottomRef.current){let{viewableDetectionEpsilon:e}=this.props;return S.isViewable(this.wrapperRef.current,this.bottomRef.current,e)}return!1}componentDidUpdate(e,t,r){this.props.debug&&console.log("Component ",this.componentDidUpdate.name);let{forceScroll:s,changeDetectionFilter:i}=this.props;i(e,this.props)&&(s||r)&&this.bottomRef.current&&this.wrapperRef.current&&this.scrollParentToChild(this.wrapperRef.current,this.bottomRef.current)}componentDidMount(){this.props.debug&&console.log("Component ",this.componentDidMount.name),this.bottomRef.current&&this.wrapperRef.current&&this.scrollParentToChild(this.wrapperRef.current,this.bottomRef.current)}scrollParentToChild(e,t){let{viewableDetectionEpsilon:r}=this.props;if(!S.isViewable(e,t,r)){let r=e.getBoundingClientRect(),s=t.getBoundingClientRect().top+e.scrollTop-r.top,{animateScroll:i,onScrollComplete:l}=this.props;i&&(i(e,s),l())}}static isViewable(e,t,r){r=r||0;let s=e.getBoundingClientRect(),i=t.getBoundingClientRect();return i.top>=s.top&&s.top+e.clientHeight-i.top+r>=0}handleScroll(){let{viewableDetectionEpsilon:e,onScroll:t}=this.props;t&&this.bottomRef.current&&this.wrapperRef.current&&t(S.isViewable(this.wrapperRef.current,this.bottomRef.current,e))}scrollToBottom(){this.bottomRef.current&&this.wrapperRef.current&&this.scrollParentToChild(this.wrapperRef.current,this.bottomRef.current)}render(){this.props.debug&&console.log("Component ",this.render.name);let{children:e,className:t}=this.props;return d.createElement("div",{className:t,style:{maxHeight:"inherit",height:"inherit",overflowY:"auto"},ref:this.wrapperRef,onScroll:this.handleScroll},e,d.createElement("div",{ref:this.bottomRef}))}}function q({message:e,userId:t,previousMessage:r}){let i=!r||r.sender!==e.sender,[l,a]=(0,d.useState)("");return s.jsx("div",{className:"",children:e?.sender===t?s.jsx("div",{className:"flex flex-col items-end",children:(0,s.jsxs)("div",{children:[i&&s.jsx("p",{className:"text-end text-sm text-muted-foreground",children:l}),s.jsx(m,{message:e})]})}):(0,s.jsxs)("div",{className:"flex flex-col items-start",children:[i&&s.jsx("p",{className:"ml-12 text-sm text-muted-foreground",children:l}),s.jsx(u,{message:e,isDifferentSender:i})]})})}S.defaultProps={forceScroll:!1,animateScroll:(e,t)=>{e.scrollBy?e.scrollBy({top:t}):e.scrollTop=t},onScrollComplete:()=>{},changeDetectionFilter:()=>!0,viewableDetectionEpsilon:2,onScroll:()=>{}};var C=r(2918),P=r(91175),k=r(94019);let _=(0,a.Z)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);function D(){let{register:e,handleSubmit:t,reset:r}=(0,v.cI)(),[a]=b(),p=(0,d.useRef)(null),{socket:u,socketLoading:m,setChatIdFromSocket:h}=(0,C.s)(),x=(0,w.LN)(),f=N.v9(R.dy)?._id,[g,S]=(0,d.useState)(!1),[D,T]=(0,d.useState)([]),[M,U]=(0,d.useState)(null),[E,z]=(0,d.useState)(null),B=(0,d.useRef)(null),[Z,G]=(0,d.useState)(null),A=async e=>{S(!0),z(null),B.current.value=null;let t={text:e?.message,receiver:x,imageUrl:""};try{if(E){let e=new FormData;e.append("image",E);let r=await a(e).unwrap();t.imageUrl=r?.data}u&&f&&u.emit("send-message",t,async e=>{}),F(null),r()}catch(e){(0,j.PK)(e?.data?.message),S(!1)}},[I,F]=(0,d.useState)(null);return s.jsx("div",{className:"relative z-10 flex flex-col rounded-xl rounded-t-xl border-t-8 border-t-primary-green bg-primary-white px-2 py-6 lg:flex-row",children:(0,s.jsxs)("div",{className:"flex flex-col justify-between lg:flex-grow lg:px-8",children:[s.jsx("div",{className:"flex-center-between border-b border-b-primary-black/20 pb-1",children:(0,s.jsxs)("div",{className:"flex-center-start gap-x-2",children:[s.jsx(l.default,{src:c.Z,alt:"Grafismo Digital logo",height:100,width:100,className:"h-16 w-16 rounded-full"}),(0,s.jsxs)("div",{className:"lg:flex-grow",children:[s.jsx("h3",{className:"text-xl font-bold text-primary-black",children:"Grafismo Digital"}),(0,s.jsxs)("div",{className:"flex-center-start gap-x-1",children:[s.jsx("div",{className:(0,P.cn)("h-2 w-2 rounded-full",M?"bg-green-500":"bg-yellow-500")}),s.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:M?"Online":"Offline"})]})]})]})}),s.jsx("div",{className:"scroll-hide max-h-[65vh] min-h-[65vh] overflow-auto py-10",ref:p,children:s.jsx("div",{children:void 0===D?s.jsx("div",{className:"flex-center min-h-[65vh] w-full gap-x-2 text-2xl font-bold",children:s.jsx(y,{size:50,className:"animate-spin",color:"#6b7280"})}):s.jsx(s.Fragment,{children:D?.length>0?D?.map((e,t)=>s.jsx(q,{message:e,userId:f,previousMessage:t>0?D[t-1]:null},e?._id)):(0,s.jsxs)("div",{className:"flex-center min-h-[65vh] w-full gap-x-2 text-2xl font-bold",children:[s.jsx(_,{}),s.jsx("p",{children:"Write me a message"})]})})})}),(0,s.jsxs)("div",{children:[I&&(0,s.jsxs)("div",{className:"border-b-none relative mx-auto w-[94%] rounded-2xl border-x border-t border-primary-black p-2",children:[s.jsx("button",{className:"absolute right-2 top-2",onClick:()=>{z(null),F(null),B.current.value=null},children:s.jsx(k.Z,{size:20})}),I&&s.jsx(l.default,{src:I,alt:"image preview",height:250,width:250,className:"h-[120px] w-auto rounded-2xl"})]}),(0,s.jsxs)("form",{onSubmit:t(A),className:"flex-center gap-x-4",children:[(0,s.jsxs)("button",{type:"button",disabled:g,className:"disabled:text-gray-400",onClick:()=>{B.current&&B.current.click()},children:[s.jsx("input",{type:"file",ref:B,className:"hidden",onChange:e=>{z(e.target.files[0])}}),s.jsx(o,{size:20})]}),s.jsx(i.I,{placeholder:"Type a message",type:"text",className:"w-full rounded-2xl border border-primary-black bg-transparent px-4 py-[22px] text-base font-medium text-primary-black",...e("message",{required:!0})}),s.jsx("button",{disabled:g,type:"submit",className:"border-none shadow-none disabled:text-gray-400",children:g?s.jsx(y,{size:22,className:"animate-spin"}):s.jsx(n,{size:22})})]})]})]})})}r(35047)},65188:(e,t,r)=>{"use strict";r.d(t,{I:()=>a});var s=r(10326),i=r(17577),l=r(91175);let a=i.forwardRef(({className:e,type:t,...r},i)=>s.jsx("input",{type:t,className:(0,l.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm font-medium shadow-sm transition-all duration-300 ease-in-out file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:i,...r}));a.displayName="Input"},23288:(e,t,r)=>{"use strict";r.d(t,{PK:()=>l,bF:()=>i});var s=r(85999);let i=(e,t)=>s.Am.success(e,{id:t}),l=(e,t)=>s.Am.error(e,{id:t})},63395:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a,metadata:()=>l});var s=r(19510);let i=(0,r(68570).createProxy)(String.raw`/root/graphics-designer-website/src/app/(protected)/chat/_components/ChatContainer.js#default`),l={title:"Chat",description:"Chat page of Grafismo Digital."};function a(){return s.jsx("div",{className:"container mt-20",children:s.jsx(i,{})})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[221,723,883],()=>r(14551));module.exports=s})();